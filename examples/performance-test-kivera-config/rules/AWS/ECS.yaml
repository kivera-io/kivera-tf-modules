---
AWS-ECS-DescribeClusters-1:
    description: kivera.cache.delete allow
    provider: AWS
    service: ECS
    actions:
        - DescribeClusters
    policy: |-
        valid {
            kivera.cache.delete("kiveradata:perftest:del:ecs")
        }
    advanced:
        paths:
            - '*'
        methods:
            - '*'
        endpoints:
            - '*'
    enforce: true
    log-request-body: true
    enable-cfn-scan: false
    tags: {}
    compliance-mappings: {}

AWS-ECS-ListAttributes-1:
    description: kivera.cache.set allow
    provider: AWS
    service: ECS
    actions:
        - ListAttributes
    policy: |-
        valid {
            kivera.cache.set("kiveradata:perftest:ecs", "a thing");
            true
        }
    advanced:
        paths:
            - '*'
        methods:
            - '*'
        endpoints:
            - '*'
    enforce: true
    log-request-body: true
    enable-cfn-scan: false
    tags: {}
    compliance-mappings: {}

AWS-ECS-ListClusters-1:
    description: Allow ListClusters
    provider: AWS
    service: ECS
    actions:
        - ListClusters
    policy: |
        valid = true
    advanced:
        paths:
            - '*'
        methods:
            - '*'
        endpoints:
            - '*'
    enforce: true
    log-request-body: true
    enable-cfn-scan: false
    tags: {}
    compliance-mappings: {}

AWS-ECS-ListServices-1:
    description: Test http.send and print functions
    provider: AWS
    service: ECS
    actions:
        - ListServices
    policy: "valid {\n    res = http.send({\n        \"method\": \"get\",\n        \"url\": \"https://api.kivera.io/healthz\"\n    })\n    \n    res[\"status_code\"] == 200\n    print(res)\n    false\n}"
    advanced:
        paths:
            - '*'
        methods:
            - '*'
        endpoints:
            - '*'
    enforce: true
    log-request-body: true
    enable-cfn-scan: false
    tags: {}
    compliance-mappings: {}

AWS-ECS-ListTaskDefinitions-1:
    description: kivera.cache.get allow
    provider: AWS
    service: ECS
    actions:
        - ListAccountSettings
    policy: |-
        valid {
            value = kivera.cache.get("kiveradata:perftest:ecs");
            value != ""
        }
    advanced:
        paths:
            - '*'
        methods:
            - '*'
        endpoints:
            - '*'
    enforce: true
    log-request-body: true
    enable-cfn-scan: false
    tags: {}
    compliance-mappings: {}

AWS-ECS-ListTaskDefinitions-2:
    description: kivera.cache.set_with_options allow
    provider: AWS
    service: ECS
    actions:
        - ListTaskDefinitions
    policy: |-
        valid {
            kivera.cache.set_with_options("kiveradata:perftest:set:ecs", "maybe_important", {"kv_cache_ttl": 300});
            true
        }
    advanced:
        paths:
            - '*'
        methods:
            - '*'
        endpoints:
            - '*'
    enforce: true
    log-request-body: true
    enable-cfn-scan: false
    tags: {}
    compliance-mappings: {}

AWS-ECS-ListTaskDefinitions-3:
    description: kivera.cache.get from set_with_options allow
    provider: AWS
    service: ECS
    actions:
        - ListAccountSettings
    policy: |-
        valid {
            value = kivera.cache.get_with_options("kiveradata:perftest:set:ecs", {"local_cache_ttl": 20});
            value != ""
        }
    advanced:
        paths:
            - '*'
        methods:
            - '*'
        endpoints:
            - '*'
    enforce: true
    log-request-body: true
    enable-cfn-scan: false
    tags: {}
    compliance-mappings: {}

